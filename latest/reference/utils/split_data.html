<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Neural Network" href="../neural_network.html" /><link rel="prev" title="Metrics and scoring" href="metrics.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Splitting Equistore TensorMaps - equisolve documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/fontawesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/solid.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/brands.min.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">equisolve  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">equisolve  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../how-to/index.html">How-to guides</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of How-to guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/linear-model.html">Computing a Linear Model</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">API reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of API reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../preprocessing.html">Preprocessing data</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../selection/index.html">Feature and Sample Selection</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Feature and Sample Selection</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../selection/greedyselector.html"><code class="docutils literal notranslate"><span class="pre">GreedySelector</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../selection/feature-selection.html">Feature selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../selection/sample-selection.html">Sample selection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models.html">Regression models</a></li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Utility functions</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Utility functions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="convert.html">Convert</a></li>
<li class="toctree-l3"><a class="reference internal" href="metrics.html">Metrics and scoring</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Splitting Equistore TensorMaps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../neural_network.html">Neural Network</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="module-equisolve.utils.split_data">
<span id="splitting-equistore-tensormaps"></span><h1>Splitting Equistore TensorMaps<a class="headerlink" href="#module-equisolve.utils.split_data" title="Link to this heading">#</a></h1>
<p>Module for splitting lists of <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code> objects into multiple
<code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code> objects along a given axis.</p>
<dl class="py function">
<dt class="sig sig-object py" id="equisolve.utils.split_data.split_data">
<span class="sig-prename descclassname"><span class="pre">equisolve.utils.split_data.</span></span><span class="sig-name descname"><span class="pre">split_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="(in metatensor)"><span class="pre">TensorMap</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="(in metatensor)"><span class="pre">TensorMap</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="(in metatensor)"><span class="pre">TensorMap</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://lab-cosmo.github.io/metatensor/latest/reference/python/labels.html#metatensor.Labels" title="(in metatensor)"><span class="pre">Labels</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/equisolve/utils/split_data.html#split_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#equisolve.utils.split_data.split_data" title="Link to this definition">#</a></dt>
<dd><p>Splits a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code> objects into multiple
<code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code> objects along a given axis.</p>
<p>For either the “samples” or “properties” <cite>axis</cite>, the unique indices for the
specified metadata <cite>name</cite> are found. If <cite>seed</cite> is set, the indices are
shuffled. Then, they are divided into <cite>n_groups</cite>, where the sizes of the
groups are specified by the <cite>group_sizes</cite> argument.</p>
<p>These grouped indices are then used to split the list of input tensors. The
split tensors, along with the grouped labels, are returned. The tensors are
returned as a list of list of <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code> objects.</p>
<p>Each list in the returned <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> corresponds
to the split :py:class`TensorMap` at the same position in the input
<cite>tensors</cite> list. Each nested list contains <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code> objects that
share no common indices for the specified <cite>axis</cite> and <cite>names</cite>. However, the
metadata on all other axes (including the keys) will be equivalent.</p>
<p>The passed list of <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code> objects in <cite>tensors</cite> must have the
same set of unique indices for the specified <cite>axis</cite> and <cite>names</cite>. For
instance, if passing an input and output tensor for splitting (i.e. as used
in supervised machine learning), the output tensor must have structure
indices 0 -&gt; 10 if the input tensor does.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensors</strong> – input <cite>list</cite> of <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code> objects, each of which
will be split into <cite>n_groups</cite> new <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code> objects.</p></li>
<li><p><strong>axis</strong> – a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> equal to either “samples” or “properties”.
This is the axis along which the input <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code> objects
will be split.</p></li>
<li><p><strong>names</strong> – a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> indicating the
samples/properties names by which the <cite>tensors</cite> will be split.</p></li>
<li><p><strong>n_groups</strong> – an <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> indicating how many new
<code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code> objects each of the tensors passed in <cite>tensors</cite>
will be split into. If <cite>group_sizes</cite> is none (default), <cite>n_groups</cite> is
used to split the data into <code class="docutils literal notranslate"><span class="pre">n</span></code> evenly sized groups according to the
unique metadata for the specified <cite>axis</cite> and <cite>names</cite>, to the nearest
integer.</p></li>
<li><p><strong>group_sizes</strong> – an ordered <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> the
group sizes to split each input <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code> into. A
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> will be interpreted as an indication
of the absolute group sizes, whereas a list of float as indicating the
relative sizes. For the former case, the sum of this list must be &lt;= the
total number of unique indices present in the input <cite>tensors</cite> for the
chosen <cite>axis</cite> and <cite>names</cite>. In the latter, the sum of this list must be
&lt;= 1.</p></li>
<li><p><strong>seed</strong> – an <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> that seeds the numpy random number
generator. Used to control shuffling of the unique indices, which
dictate the data that ends up in each of the split output tensors. If
None (default), no shuffling of the indices occurs. If a
<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, shuffling is executed but with a random seed set to
this value.</p></li>
</ul>
</dd>
<dt class="field-even">Return split_tensors<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of
<code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code>. The <code class="docutils literal notranslate"><span class="pre">i</span></code> th element in the list contains
<cite>n_groups</cite> <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code> objects corresponding to the split ith
<code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code> of the input list <cite>tensors</cite>.</p>
</dd>
<dt class="field-odd">Return grouped_labels<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Labels</span></code> corresponding to the
unique indices according to the specified <cite>axis</cite> and <cite>names</cite> that are
present in each of the returned groups of <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code>. The
length of this list is <cite>n_groups</cite>.</p>
</dd>
</dl>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h2>
<p>Split a TensorMap <cite>tensor</cite> into 2 new TensorMaps along the “samples” axis
for the “structure” metadata. Without specifying <cite>group_sizes</cite>, the data
will be split equally by structure index. If the number of unique strutcure
indices present in the input data is not exactly divisible by <cite>n_groups</cite>,
the group sizes will be made to the nearest int. Without specifying
<cite>seed</cite>, no shuffling of the structure indices will occur and they
will be grouped in lexigraphical order. For instance, if the input tensor
has structure indices 0 -&gt; 9 (inclusive), the first new tensor will contain
only structure indices 0 -&gt; 4 (inc.) and the second will contain only 5 -&gt; 9
(inc).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">equisolve.utils</span> <span class="kn">import</span> <span class="n">split_data</span>

<span class="p">[[</span><span class="n">new_tensor_1</span><span class="p">,</span> <span class="n">new_tensor_2</span><span class="p">]],</span> <span class="n">grouped_labels</span> <span class="o">=</span> <span class="n">split_data</span><span class="p">(</span>
    <span class="n">tensors</span><span class="o">=</span><span class="n">tensor</span><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;samples&quot;</span><span class="p">,</span>
    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">],</span>
    <span class="n">n_groups</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Split 2 tensors corresponding to input and output data into train and test
data, with a relative 80:20 ratio. If both input and output tensors contain
structure indices 0 -&gt; 9 (inclusive), the <cite>in_train</cite> and <cite>out_train</cite> tensors
will contain structure indices 0 -&gt; 7 (inc.) and the <cite>in_test</cite> and
<cite>out_test</cite> tensors will contain structure indices 8 -&gt; 9 (inc.). As we want
to specify relative group sizes, we will pass <cite>group_sizes</cite> as a list of
float. Specifying the <cite>seed</cite> will shuffle the structure indices
before the groups are made.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">equisolve.utils</span> <span class="kn">import</span> <span class="n">split_data</span>

<span class="p">[[</span><span class="n">in_train</span><span class="p">,</span> <span class="n">in_test</span><span class="p">],</span> <span class="p">[</span><span class="n">out_train</span><span class="p">,</span> <span class="n">out_test</span><span class="p">]],</span> <span class="n">grouped_labels</span> <span class="o">=</span> <span class="n">split_data</span><span class="p">(</span>
    <span class="n">tensors</span><span class="o">=</span><span class="p">[</span><span class="nb">input</span><span class="p">,</span> <span class="n">output</span><span class="p">],</span>
    <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;samples&quot;</span><span class="p">,</span>
    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">],</span>
    <span class="n">n_groups</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>                  <span class="c1"># for train-test split</span>
    <span class="n">group_sizes</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>  <span class="c1"># relative, a 80% 20% train-test split</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Split 2 tensors corresponding to input and output data into train, test, and
validation data. If input and output tensors have the same 10 structure
indices, we can split such that the train, test, and val tensors have 7,
2, and 1 structures in each, respectively. We want to specify absolute
group sizes, so will pass a list of int. Specifying the <cite>seed</cite> will
shuffle the structure indices before they are grouped.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">metatensor</span>
<span class="kn">from</span> <span class="nn">equisolve.utils</span> <span class="kn">import</span> <span class="n">split_data</span>

<span class="c1"># Find the unique structure indices in the input tensor</span>
<span class="n">unique_structure_indices</span> <span class="o">=</span> <span class="n">metatensor</span><span class="o">.</span><span class="n">unique_metadata</span><span class="p">(</span>
    <span class="n">tensor</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;samples&quot;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="c1"># They run from 0 -&gt; 10 (inclusive)</span>
<span class="n">unique_structure_indices</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Labels</span><span class="p">(</span>
    <span class="p">[(</span><span class="mi">0</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,)],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;structure&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;i4&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="c1"># Verify that the output has the same unique structure indices</span>
<span class="k">assert</span> <span class="n">unique_structure_indices</span> <span class="o">==</span> <span class="n">metatensor</span><span class="o">.</span><span class="n">unique_metadata</span><span class="p">(</span>
    <span class="n">tensor</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;samples&quot;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kc">True</span>

<span class="c1"># Split the data by structure index, with an abolute split of 7, 2, 1</span>
<span class="c1"># for the train, test, and validation tensors, respectively</span>
<span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="n">in_train</span><span class="p">,</span> <span class="n">in_test</span><span class="p">,</span> <span class="n">in_val</span><span class="p">],</span>
        <span class="p">[</span><span class="n">out_train</span><span class="p">,</span> <span class="n">out_test</span><span class="p">,</span> <span class="n">out_val</span><span class="p">]</span>
    <span class="p">]</span>
<span class="p">),</span> <span class="n">grouped_labels</span> <span class="o">=</span> <span class="n">split_data</span><span class="p">(</span>
    <span class="n">tensors</span><span class="o">=</span><span class="p">[</span><span class="nb">input</span><span class="p">,</span> <span class="n">output</span><span class="p">],</span>
    <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;samples&quot;</span><span class="p">,</span>
    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">],</span>
    <span class="n">n_groups</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># for train-test-validation</span>
    <span class="n">group_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># absolute; 7, 2, 1 for train, test, val</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Inspect the grouped structure indices</span>
<span class="n">grouped_labels</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span>
    <span class="n">Labels</span><span class="p">(</span>
        <span class="p">[(</span><span class="mi">3</span><span class="p">,),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,)],</span>
        <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;structure&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;i4&#39;</span><span class="p">)]</span>
    <span class="p">),</span>
    <span class="n">Labels</span><span class="p">([(</span><span class="mi">4</span><span class="p">,),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,)],</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;structure&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;i4&#39;</span><span class="p">)]),</span>
    <span class="n">Labels</span><span class="p">([(</span><span class="mi">5</span><span class="p">,)],</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;structure&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;i4&#39;</span><span class="p">)]),</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../neural_network.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Neural Network</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="metrics.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Metrics and scoring</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; All source code is available under the BSD3 License
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link fa-brands fa-github fa-2x" href="https://github.com/lab-cosmo/equisolve" aria-label="GitHub"></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Splitting Equistore TensorMaps</a><ul>
<li><a class="reference internal" href="#equisolve.utils.split_data.split_data"><code class="docutils literal notranslate"><span class="pre">split_data()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>