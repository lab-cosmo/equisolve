<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="API reference" href="../reference/index.html" /><link rel="prev" title="How-to guides" href="../how-to/index.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Computing a Linear Model - equisolve documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/fontawesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/solid.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/brands.min.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">equisolve  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">equisolve  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../how-to/index.html">How-to guides</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of How-to guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Computing a Linear Model</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/index.html">API reference</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of API reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/preprocessing.html">Preprocessing data</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/selection/index.html">Feature and Sample Selection</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Feature and Sample Selection</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/selection/greedyselector.html"><code class="docutils literal notranslate"><span class="pre">GreedySelector</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/selection/feature-selection.html">Feature selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/selection/sample-selection.html">Sample selection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/models.html">Regression models</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/utils/index.html">Utility functions</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Utility functions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/utils/convert.html">Convert</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/utils/metrics.html">Metrics and scoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/utils/split_data.html">Splitting Equistore TensorMaps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/neural_network.html">Neural Network</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-linear-model-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="computing-a-linear-model">
<span id="sphx-glr-examples-linear-model-py"></span><h1>Computing a Linear Model<a class="headerlink" href="#computing-a-linear-model" title="Link to this heading">#</a></h1>
<p>In this tutorial we calculate a linear model using Ridge regression.
If you are never worked with metatensor objects before please take a look at
the documentation.</p>
<p>For constructing a linear Model we need the atomic descriptor as training data
<code class="docutils literal notranslate"><span class="pre">X</span></code> as well as the energies and forces as target data <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<p>We first import all necessary packages.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ase.io</span>
<span class="kn">import</span> <span class="nn">metatensor</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">rascaline</span> <span class="kn">import</span> <a href="https://luthaf.fr/rascaline/latest/references/api/python/calculators.html#rascaline.SoapPowerSpectrum" title="rascaline.SoapPowerSpectrum" class="sphx-glr-backref-module-rascaline sphx-glr-backref-type-py-class"><span class="n">SoapPowerSpectrum</span></a>

<span class="kn">from</span> <span class="nn">equisolve.numpy.models.linear_model</span> <span class="kn">import</span> <a href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module" title="torch.nn.Module" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-class"><span class="n">Ridge</span></a>
<span class="kn">from</span> <span class="nn">equisolve.utils.convert</span> <span class="kn">import</span> <a href="../reference/utils/convert.html#equisolve.utils.convert.ase_to_tensormap" title="equisolve.utils.ase_to_tensormap" class="sphx-glr-backref-module-equisolve-utils sphx-glr-backref-type-py-function"><span class="n">ase_to_tensormap</span></a>
</pre></div>
</div>
<section id="dataset">
<h2>Dataset<a class="headerlink" href="#dataset" title="Link to this heading">#</a></h2>
<p>As data set we use the SHIFTML set. You can obtain the dataset used in this
example from our <a class="reference download internal" download="" href="../_downloads/baed817b984659f054f6dbda1066cc00/dataset.xyz"><code class="xref download docutils literal notranslate"><span class="pre">website</span></code></a>.
We read the first 20 structures of the data set using
<a class="reference external" href="https://wiki.fysik.dtu.dk/ase/">ASE</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">frames</span></a> <span class="o">=</span> <a href="https://wiki.fysik.dtu.dk/ase/ase/io/io.html#ase.io.read" title="ase.io.read" class="sphx-glr-backref-module-ase-io sphx-glr-backref-type-py-function"><span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read</span></a><span class="p">(</span><span class="s2">&quot;dataset.xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;:20&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The data set contains everything we need for the model:
The atomic positions we use for the descriptor and with this as
training data. The data set also stores the energies and forces which will be our
target data we regress against.</p>
</section>
<section id="training-data">
<h2>Training data<a class="headerlink" href="#training-data" title="Link to this heading">#</a></h2>
<p>We construct the descriptor training data with a SOAP powerspectrum using
rascaline. We first define the hyper parameters for the calculation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">HYPER_PARAMETERS</span></a> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;cutoff&quot;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span>
    <span class="s2">&quot;max_radial&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="s2">&quot;max_angular&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s2">&quot;atomic_gaussian_width&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="s2">&quot;center_atom_weight&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="s2">&quot;radial_basis&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;Gto&quot;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="p">},</span>
    <span class="s2">&quot;cutoff_function&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;ShiftedCosine&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span>
    <span class="p">},</span>
<span class="p">}</span>

<a href="https://luthaf.fr/rascaline/latest/references/api/python/calculators.html#rascaline.SoapPowerSpectrum" title="rascaline.SoapPowerSpectrum" class="sphx-glr-backref-module-rascaline sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">calculator</span></a> <span class="o">=</span> <a href="https://luthaf.fr/rascaline/latest/references/api/python/calculators.html#rascaline.SoapPowerSpectrum" title="rascaline.SoapPowerSpectrum" class="sphx-glr-backref-module-rascaline sphx-glr-backref-type-py-class"><span class="n">SoapPowerSpectrum</span></a><span class="p">(</span><span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">HYPER_PARAMETERS</span></a><span class="p">)</span>
</pre></div>
</div>
<p>And then run the actual calculation, including gradients with respect to positions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">descriptor</span></a> <span class="o">=</span> <a href="https://luthaf.fr/rascaline/latest/references/api/python/calculators.html#rascaline.SoapPowerSpectrum" title="rascaline.SoapPowerSpectrum" class="sphx-glr-backref-module-rascaline sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">calculator</span></a><span class="o">.</span><span class="n">compute</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">frames</span></a><span class="p">,</span> <span class="n">gradients</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;positions&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>For more details on how the descriptor works see the documentation of
rascaline.</p>
<p>We now move all keys into properties to access them for our model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">descriptor</span></a> <span class="o">=</span> <a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap.keys_to_samples" title="metatensor.TensorMap.keys_to_samples" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-method"><span class="n">descriptor</span><span class="o">.</span><span class="n">keys_to_samples</span></a><span class="p">(</span><span class="s2">&quot;species_center&quot;</span><span class="p">)</span>
<a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">descriptor</span></a> <span class="o">=</span> <a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap.keys_to_properties" title="metatensor.TensorMap.keys_to_properties" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-method"><span class="n">descriptor</span><span class="o">.</span><span class="n">keys_to_properties</span></a><span class="p">([</span><span class="s2">&quot;species_neighbor_1&quot;</span><span class="p">,</span> <span class="s2">&quot;species_neighbor_2&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>The descriptor contains a represenantion with respect to each central atoms per
structure. However, our energies as target data is per structure only.
Therefore, we sum the properties of each center atom per structure.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X</span></a> <span class="o">=</span> <a href="https://lab-cosmo.github.io/metatensor/latest/reference/operations/manipulation/samples-reduction.html#metatensor.sum_over_samples" title="metatensor.sum_over_samples" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-function"><span class="n">metatensor</span><span class="o">.</span><span class="n">sum_over_samples</span></a><span class="p">(</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">descriptor</span></a><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="s2">&quot;species_center&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>The newly defined <a class="reference external" href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="(in metatensor)"><code class="xref py py-class docutils literal notranslate"><span class="pre">metatensor.TensorMap</span></code></a> contains a single block</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap.blocks" title="metatensor.TensorMap.blocks" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-method"><span class="n">X</span><span class="o">.</span><span class="n">blocks</span></a><span class="p">())</span><span class="si">}</span><span class="s2"> block.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>X contains 1 block.
</pre></div>
</div>
<p>As well as 1800 properties and 20 sample.</p>
<p>We acces the data using the :meth:<code class="docutils literal notranslate"><span class="pre">metatensor.TensorMap.block</span></code> method</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span><span class="si">}</span><span class="s2"> properties.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/labels.html#metatensor.Labels" title="metatensor.Labels" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">samples</span></a><span class="p">)</span><span class="si">}</span><span class="s2"> samples.&quot;</span><span class="p">)</span>

<span class="c1"># Target data</span>
<span class="c1"># -----------</span>
<span class="c1">#</span>
<span class="c1"># We construct the target data by converting energies and forces into a</span>
<span class="c1"># :class:`equisolve.TensorMap`.</span>


<a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y</span></a> <span class="o">=</span> <a href="../reference/utils/convert.html#equisolve.utils.convert.ase_to_tensormap" title="equisolve.utils.ase_to_tensormap" class="sphx-glr-backref-module-equisolve-utils sphx-glr-backref-type-py-function"><span class="n">ase_to_tensormap</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">frames</span></a><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="s2">&quot;energy&quot;</span><span class="p">,</span> <span class="n">forces</span><span class="o">=</span><span class="s2">&quot;forces&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>X contains 1800 properties.
X contains 20 samples.
</pre></div>
</div>
<p>The target data y contains a single block</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y</span></a><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>TensorBlock
    samples (20): [&#39;structure&#39;]
    components (): []
    properties (1): [&#39;property&#39;]
    gradients: [&#39;positions&#39;]
</pre></div>
</div>
</section>
<section id="construct-the-model">
<h2>Construct the model<a class="headerlink" href="#construct-the-model" title="Link to this heading">#</a></h2>
<p>We first initilize the <code class="xref py py-class docutils literal notranslate"><span class="pre">equisolve.numpy.models.linear_model.Ridge</span></code>
object. We automically learn on forces if forces are present.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <a href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module" title="torch.nn.Module" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-class"><span class="n">Ridge</span></a><span class="p">()</span>
</pre></div>
</div>
<p>Before we fit a model we have to define our regulerizer values.</p>
<p>For this we create a TensorMap containing the desired regulerizer values.
Here we chose a regulerizer strength of <span class="math notranslate nohighlight">\(1 \cdot 10^-5\)</span>. Note that
without standardizing the features and values the regulerizer strength
depends on the system and has to be taken carefully and usually optimized.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a> <span class="o">=</span> <a href="https://lab-cosmo.github.io/metatensor/latest/reference/operations/creation/ones_like.html#metatensor.ones_like" title="metatensor.ones_like" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-function"><span class="n">metatensor</span><span class="o">.</span><span class="n">ones_like</span></a><span class="p">(</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X</span></a><span class="p">)</span>
<a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a> <span class="o">=</span> <a href="https://lab-cosmo.github.io/metatensor/latest/reference/operations/math/multiply.html#metatensor.multiply" title="metatensor.multiply" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-function"><span class="n">metatensor</span><span class="o">.</span><span class="n">multiply</span></a><span class="p">(</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="p">,</span> <span class="mf">1e-5</span><span class="p">)</span>
</pre></div>
</div>
<p>So far <code class="docutils literal notranslate"><span class="pre">alpha</span></code> contains the same number of samples as <code class="docutils literal notranslate"><span class="pre">X</span></code>. However,
the regulerizer must only contain a single sample, because all samples will be
regulerized in the same way in a linear model.</p>
<p>We remove all sample except the 0th one by using the
<a class="reference external" href="https://lab-cosmo.github.io/metatensor/latest/reference/operations/manipulation/slice.html#metatensor.slice" title="(in metatensor)"><code class="xref py py-func docutils literal notranslate"><span class="pre">metatensor.slice()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/labels.html#metatensor.Labels" title="metatensor.Labels" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">samples</span></a> <span class="o">=</span> <a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/labels.html#metatensor.Labels" title="metatensor.Labels" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class"><span class="n">metatensor</span><span class="o">.</span><span class="n">Labels</span></a><span class="p">(</span>
    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">],</span>
    <span class="n">values</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([(</span><span class="mi">0</span><span class="p">,)]),</span>
<span class="p">)</span>

<a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a> <span class="o">=</span> <a href="https://lab-cosmo.github.io/metatensor/latest/reference/operations/manipulation/slice.html#metatensor.slice" title="metatensor.slice" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-function"><span class="n">metatensor</span><span class="o">.</span><span class="n">slice</span></a><span class="p">(</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;samples&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/labels.html#metatensor.Labels" title="metatensor.Labels" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">samples</span></a><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>TensorMap with 1 blocks
keys: _
      0
</pre></div>
</div>
<p>In our regulerizer we use the same values for all properties. However,
<code class="xref py py-class docutils literal notranslate"><span class="pre">equisolve.numpy.models.linear_model.Ridge</span></code> can also handle different
regularization for each property. You can apply a property wise
regularization by setting <code class="docutils literal notranslate"><span class="pre">&quot;values&quot;</span></code> of <code class="docutils literal notranslate"><span class="pre">alpha</span></code> with an 1d array of the
same length as the number of properties in the training data X (here 7200).</p>
<p>Next we create a sample weighting <code class="xref py py-class docutils literal notranslate"><span class="pre">equistiore.TensorMap</span></code> that weights
energies five times more then the forces.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sw</span></a> <span class="o">=</span> <a href="https://lab-cosmo.github.io/metatensor/latest/reference/operations/creation/ones_like.html#metatensor.ones_like" title="metatensor.ones_like" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-function"><span class="n">metatensor</span><span class="o">.</span><span class="n">ones_like</span></a><span class="p">(</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y</span></a><span class="p">)</span>
<a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sw</span></a> <span class="o">=</span> <a href="https://lab-cosmo.github.io/metatensor/latest/reference/operations/math/multiply.html#metatensor.multiply" title="metatensor.multiply" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-function"><span class="n">metatensor</span><span class="o">.</span><span class="n">multiply</span></a><span class="p">(</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sw</span></a><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>
</pre></div>
</div>
<p>The function <cite>equisolve.utils.dictionary_to_tensormap</cite> create a
<a class="reference external" href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="(in metatensor)"><code class="xref py py-class docutils literal notranslate"><span class="pre">metatensor.TensorMap</span></code></a> with the same shape as our target data <code class="docutils literal notranslate"><span class="pre">y</span></code> but
with values a defined by <code class="docutils literal notranslate"><span class="pre">sw_dict</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sw</span></a><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>TensorBlock
    samples (20): [&#39;structure&#39;]
    components (): []
    properties (1): [&#39;property&#39;]
    gradients: [&#39;positions&#39;]
</pre></div>
</div>
<p>Finally, we can fit the model using the regulerizer and sample weights as
defined above.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X</span></a><span class="p">,</span> <a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y</span></a><span class="p">,</span> <a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="o">=</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sw</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>TorchRidge()
</pre></div>
</div>
<p>We now predict values and calculate the root mean squre error
of our model using the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE energies = </span><span class="si">{</span><span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X</span></a><span class="p">,</span><span class="w"> </span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y</span></a><span class="p">,</span><span class="w"> </span><span class="n">parameter_key</span><span class="o">=</span><span class="s1">&#39;values&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE forces = </span><span class="si">{</span><span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X</span></a><span class="p">,</span><span class="w"> </span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y</span></a><span class="p">,</span><span class="w"> </span><span class="n">parameter_key</span><span class="o">=</span><span class="s1">&#39;positions&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> eV/Å&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>RMSE energies = 0.105 eV
RMSE forces = 0.209 eV/Å
</pre></div>
</div>
<p>If you only want to predict values you can use the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">equisolve.numpy.models.linear_model.Ridge.predict()</span></code> method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><a href="https://lab-cosmo.github.io/metatensor/latest/reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap" class="sphx-glr-backref-module-metatensor sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">X</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>TensorMap with 1 blocks
keys: _
      0
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-linear-model-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/7a7b5e8dcc95ec84983418a7c9e9138e/linear-model.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">linear-model.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/9e7e034fc905620c703930a67fc9c6b5/linear-model.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">linear-model.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../reference/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">API reference</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../how-to/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">How-to guides</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; All source code is available under the BSD3 License
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link fa-brands fa-github fa-2x" href="https://github.com/lab-cosmo/equisolve" aria-label="GitHub"></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Computing a Linear Model</a><ul>
<li><a class="reference internal" href="#dataset">Dataset</a></li>
<li><a class="reference internal" href="#training-data">Training data</a></li>
<li><a class="reference internal" href="#construct-the-model">Construct the model</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>